{"is_source_file": true, "format": "Python", "description": "This file contains database management functions for initializing the database schema, obtaining database connections, and performing user-related database operations such as retrieving and creating users. It utilizes sqlite3 for database interaction and is likely part of a backend API for user authentication.", "external_files": ["from .config import settings"], "external_methods": ["settings.DB_FILE"], "published": ["init_db", "get_db", "get_user_by_email", "create_user"], "classes": [], "methods": [{"name": "None _ensure_parent_dir(path: str)", "description": "Ensures the parent directory for the specified database file exists, creating it if necessary.", "scope": "", "scopeKind": ""}, {"name": "None init_db()", "description": "Initializes the database schema by creating the users table if it does not already exist.", "scope": "", "scopeKind": ""}, {"name": "Iterator[sqlite3.Connection] get_db()", "description": "Provides a context-managed SQLite connection, enabling safe use of database operations within a with statement.", "scope": "", "scopeKind": ""}, {"name": "Optional[sqlite3.Row] get_user_by_email(conn: sqlite3.Connection, email: str)", "description": "Retrieves a user record by email. Returns a sqlite3.Row object or None if not found.", "scope": "", "scopeKind": ""}, {"name": "int create_user(conn: sqlite3.Connection, email: str, password_hash: str)", "description": "Inserts a new user record into the database and returns the assigned ID.", "scope": "", "scopeKind": ""}], "calls": ["os.path.dirname", "os.path.exists", "os.makedirs", "settings.DB_FILE", "sqlite3.connect", "conn.execute", "conn.cursor", "cursor.execute", "conn.commit", "cursor.fetchone"], "search-terms": ["database initialization", "SQLite backend", "user model", "mysql/sqlite/orm", "user creation", "schema setup"], "state": 2, "file_id": 6, "knowledge_revision": 13, "git_revision": "", "ctags": [{"_type": "tag", "name": "_ensure_parent_dir", "path": "/home/kavia/workspace/code-generation/natural-query-processing-platform-96847-96856/dsp_backend/src/api/db.py", "pattern": "/^def _ensure_parent_dir(path: str) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(path: str)"}, {"_type": "tag", "name": "create_user", "path": "/home/kavia/workspace/code-generation/natural-query-processing-platform-96847-96856/dsp_backend/src/api/db.py", "pattern": "/^def create_user(conn: sqlite3.Connection, email: str, password_hash: str) -> int:$/", "language": "Python", "typeref": "typename:int", "kind": "function", "signature": "(conn: sqlite3.Connection, email: str, password_hash: str)"}, {"_type": "tag", "name": "get_db", "path": "/home/kavia/workspace/code-generation/natural-query-processing-platform-96847-96856/dsp_backend/src/api/db.py", "pattern": "/^def get_db() -> Iterator[sqlite3.Connection]:$/", "language": "Python", "typeref": "typename:Iterator[sqlite3.Connection]", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "get_user_by_email", "path": "/home/kavia/workspace/code-generation/natural-query-processing-platform-96847-96856/dsp_backend/src/api/db.py", "pattern": "/^def get_user_by_email(conn: sqlite3.Connection, email: str) -> Optional[sqlite3.Row]:$/", "language": "Python", "typeref": "typename:Optional[sqlite3.Row]", "kind": "function", "signature": "(conn: sqlite3.Connection, email: str)"}, {"_type": "tag", "name": "init_db", "path": "/home/kavia/workspace/code-generation/natural-query-processing-platform-96847-96856/dsp_backend/src/api/db.py", "pattern": "/^def init_db() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}], "hash": "737c0a33a247e0f58f9ba51deb5033d1", "format-version": 4, "code-base-name": "dsp_backend", "filename": "dsp_backend/src/api/db.py", "revision_history": [{"13": ""}]}